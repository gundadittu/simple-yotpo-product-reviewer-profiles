<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/jquery-modal/0.9.1/jquery.modal.min.js"></script>
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/jquery-modal/0.9.1/jquery.modal.min.css" />

<!-- TODO: remove this -->
<link rel="stylesheet" href="https://protected-depths-25820.herokuapp.com/styles.css" />

<script>
  function attachProfileLinks() {
    $("div.yotpo-review.yotpo-regular-box").each(function(_, _) {
      const reviewId = $(this).attr("data-review-id");
      const requestUrl= $("#real-reviews-pop-up").attr("data-url")+'/reviewer-profile/'+reviewId;
     
      const yotpoReviewHeaderDiv = $(this).find("div.yotpo-header");
//             $(this).find("span.yotpo-icon-profile.yotpo-header-element.pull-left");
      
      yotpoReviewHeaderDiv.click(function() { 
        $("#real-reviews-pop-up").empty();
        $('#real-reviews-pop-up').append("Loading...");
      	$("#real-reviews-pop-up").modal();
        $.ajax({
          url : requestUrl,
          type: 'GET',
          headers: { 'Access-Control-Allow-Origin': '*' },
          dataType: "html",
          success: function(html){
             $('#real-reviews-pop-up').empty();
             $('#real-reviews-pop-up').append(html);
          },
          error: function(xhr, ajaxOptions, thrownError) {
            $('#real-reviews-pop-up').empty();
            $('#real-reviews-pop-up').append("Something went wrong...");
          }
      	});
      });
      yotpoReviewHeaderDiv.css('cursor', 'pointer');
    });
  }
  window.onload = attachProfileLinks;
</script>